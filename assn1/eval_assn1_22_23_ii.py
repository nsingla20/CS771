# -*- coding: utf-8 -*-
"""eval_assn1_22-23-II.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1UBmZ8iOjJu-HfZdlfKO4PBM9xZkGGxQv
"""

import numpy as np
from github.CS771.assn1.submit.submit import my_fit
from github.CS771.assn1.submit.submit import my_predict
import time as tm
import pickle
import os

R = 64
S = 4

Z_trn = np.loadtxt( "secret_train.dat" )
Z_tst = np.loadtxt( "secret_test.dat" )

n_trials = 5

t_train = 0
m_size = 0
t_test = 0
acc = 0

for t in range( n_trials ):
	tic = tm.perf_counter()
	model = my_fit( Z_trn )
	toc = tm.perf_counter()
	t_train += toc - tic

	with open( f"model_dump_{t}.pkl", "wb" ) as outfile:
		pickle.dump( model, outfile, protocol=pickle.HIGHEST_PROTOCOL )

	m_size += os.path.getsize( f"model_dump_{t}.pkl" )

	tic = tm.perf_counter()
	pred = my_predict( Z_tst[:, :-1], model )
	toc = tm.perf_counter()
	t_test += toc - tic

	acc += np.average( Z_tst[ :, -1 ] == pred )

t_train /= n_trials
t_test /= n_trials
m_size /= n_trials
acc /= n_trials

print( t_train, t_test, m_size, acc )
